from fastapi import FastAPI
from pydantic import BaseModel
from typing import List

app = FastAPI()

# 通用输入
class PromptInput(BaseModel):
    prompt: str

# Breakdown 输入
class BreakdownInput(BaseModel):
    episodeId: str
    visualStyle: str
    targetMedia: str
    aspectRatio: str

# Motion 返回
class MotionOutput(BaseModel):
    motionPrompt: str

@app.post("/breakdown")
def do_breakdown(data: BreakdownInput):
    prompt = f"{data.visualStyle} style, {data.targetMedia} composition, {data.aspectRatio} aspect ratio, cinematic lighting"
    return {"prompt": prompt}

@app.post("/beatboard")
def generate_beatboard(data: PromptInput):
    base = data.prompt
    prompts = [f"{base}, scene {i+1}" for i in range(9)]
    return {"prompts": prompts}

@app.post("/sequence")
def generate_sequence(data: PromptInput):
    base = data.prompt
    prompts = [
        f"{base}, opening scene",
        f"{base}, rising action",
        f"{base}, climax scene",
        f"{base}, ending shot"
    ]
    return {"prompts": prompts}

@app.post("/motion", response_model=MotionOutput)
def generate_motion(data: PromptInput):
    return {
        "motionPrompt": f"{data.prompt}, dynamic camera movement, panning shot, animated elements"
    }